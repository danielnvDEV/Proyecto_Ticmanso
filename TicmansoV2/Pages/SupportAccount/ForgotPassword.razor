@using Microsoft.AspNetCore.Components.Authorization
@using TicmansoV2.Authentication
@using TicmansoV2.Shared.Contracts
@using MudBlazor
@using System.Security.Claims
@using System.IdentityModel.Tokens.Jwt


@page "/forgot-paswword"
@layout LoginLayout
@inject ISnackbar Snackbar
@inject IJSRuntime JSRuntime
@inject HttpClient HttpClient
@inject IUserAccount AccountRepository
@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager NavManager

<PageTitle>Olvidé mi contraseña</PageTitle>
<MudGrid Justify="Justify.Center" AlignContent="AlignContent.Center" Class="loginGrid d-flex">
    <MudItem xs="12" sm="6">
        <MudCard Square="false" Class="cmptCentrado rounded-lg mt-4">
            <MudCardHeader>
                <MudText Typo="Typo.h6">Olvidé mi contraseña</MudText>
            </MudCardHeader>
            <MudCardContent>
                <MudTextField @bind-Value="ForgotPasswordEmail"
                              Label="Dirección de correo"
                              HelperText="Escriba su correo con el que está dado de alta en la plataforma para enviar el correo con los pasos para cambiar la contraseña"
                              Variant="Variant.Outlined"
                              Class="mb-3" />
            </MudCardContent>
            <MudCardActions>
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" OnClick="SendForgotPasswordEmail">Enviar</MudButton>
            </MudCardActions>
        </MudCard>
    </MudItem>
</MudGrid>
@code{
    string ForgotPasswordEmail { get; set; }

    private async Task SendForgotPasswordEmail()
    {
        try
        {
            var response = await AccountRepository.ForgotPassword(ForgotPasswordEmail);
        }
        catch (Exception)
        {
            Snackbar.Add("Ha ocurrido un error al enviar el correo");
        }
       

    }

}