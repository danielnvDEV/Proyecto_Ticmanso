@using Microsoft.AspNetCore.Identity
@using TicmansoV2.Pages
@using MudBlazor
@using System.Text.RegularExpressions
@using System.ComponentModel.DataAnnotations
@using System.Text
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Authorization
@using System.Security.Claims
@using System.IdentityModel.Tokens.Jwt
@using TicmansoV2.Authentication
@using TicmansoV2.Shared.Contracts

@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager NavManager

<MudDialog>
    <DialogContent>
        ¿Deseas salir?
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancelar</MudButton>
        <MudButton Color="Color.Primary" OnClick="Submit">Sí</MudButton>
    </DialogActions>
</MudDialog>
@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    async Task Submit()
    {
        await Logout();
        MudDialog.Close(DialogResult.Ok(true));
    }

    void Cancel() => MudDialog.Cancel();



    private async Task Logout()
    {
        var customAuthStateProvider = (CustomAuthenticationStateProvider)AuthStateProvider;
        await customAuthStateProvider.UpdateAuthenticationState(null!);
        NavManager.NavigateTo("/", forceLoad: true);
    }

}
